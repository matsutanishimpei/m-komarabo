<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½œå“ã‚’æŠ•ç¨¿ - ãƒ¯ã‚¯ãƒ¯ã‚¯è©¦ä½œå®¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }

        .mono {
            font-family: 'JetBrains Mono', monospace;
        }

        .step {
            transition: all 0.3s ease;
        }

        .step.active {
            border-color: #8b5cf6;
        }
    </style>
</head>

<body class="bg-slate-900 min-h-screen">
    <!-- Header -->
    <header class="border-b border-slate-800 px-6 py-4 mb-8 bg-slate-900/50 backdrop-blur-sm sticky top-0 z-50">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <a href="wakuwaku.html"
                class="text-slate-400 hover:text-white transition text-sm font-medium flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                æˆ»ã‚‹
            </a>
            <h1 class="text-xl font-semibold text-white">
                ä½œå“ã‚’æŠ•ç¨¿
            </h1>
            <div class="w-16"></div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-6 pb-20">
        <!-- Hero -->
        <div class="text-center mb-12">
            <h2 class="text-3xl font-semibold text-white mb-3">
                ã‚ãªãŸã®ã€ŒåˆæœŸè¡å‹•ã€ã‚’å°å°ã—ã‚ˆã†
            </h2>
            <p class="text-slate-400 text-sm">
                AIã¨ã®å£æ‰“ã¡å±¥æ­´ã¯ã€æŠ•ç¨¿å¾Œã«ä¸€åˆ‡ã®ä¿®æ­£ãŒã§ãã¾ã›ã‚“ã€‚å½“æ™‚ã®ç†±é‡ã‚’ãã®ã¾ã¾æ®‹ã—ã¦ãã ã•ã„ã€‚
            </p>
        </div>

        <!-- Steps -->
        <div class="space-y-6">
            <!-- STEP 1: å£æ‰“ã¡ã®æº–å‚™ -->
            <div id="step1" class="step active border-2 border-slate-700 rounded-2xl p-8 bg-slate-800/50">
                <div class="flex items-center gap-3 mb-6">
                    <div
                        class="w-10 h-10 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 font-semibold border border-purple-500/30">
                        1
                    </div>
                    <h3 class="text-xl font-semibold text-white">å£æ‰“ã¡ã®æº–å‚™</h3>
                </div>

                <p class="text-slate-300 mb-6 leading-relaxed">
                    ã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦AIã¨å¯¾è©±ã—ã€ã‚ãªãŸã«ã—ã‹ä½œã‚Œãªã„ã‚¢ãƒ—ãƒªã‚’ç·´ã‚Šä¸Šã’ã¦ãã ã•ã„ã€‚
                </p>

                <div class="bg-slate-900 border border-slate-700 rounded-xl p-6 mb-4 relative">
                    <pre id="basePrompt"
                        class="text-sm text-slate-300 whitespace-pre-wrap leading-relaxed">èª­ã¿è¾¼ã¿ä¸­...</pre>
                    <button onclick="copyPrompt()"
                        class="absolute top-4 right-4 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white text-sm font-medium rounded-lg transition flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
                            </path>
                        </svg>
                        ã‚³ãƒ”ãƒ¼
                    </button>
                </div>

                <p class="text-xs text-slate-500">
                    ğŸ’¡ ãƒ’ãƒ³ãƒˆ: ChatGPTã€Claudeã€Geminiãªã©ã€ãŠå¥½ããªAIã§OKã§ã™ã€‚
                </p>
            </div>

            <!-- STEP 2: é­‚ã®å°å° -->
            <div id="step2" class="step border-2 border-slate-700 rounded-2xl p-8 bg-slate-800/50">
                <div class="flex items-center gap-3 mb-6">
                    <div
                        class="w-10 h-10 rounded-full bg-red-500/20 flex items-center justify-center text-red-400 font-semibold border border-red-500/30">
                        2
                    </div>
                    <h3 class="text-xl font-semibold text-white">é­‚ã®å°å°ï¼ˆå±¥æ­´ã®è²¼ã‚Šä»˜ã‘ï¼‰</h3>
                </div>

                <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-4 mb-6">
                    <p class="text-red-300 text-sm font-medium flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                            </path>
                        </svg>
                        âš ï¸ ã“ã®é …ç›®ã¯æŠ•ç¨¿å¾Œã«ä¸€åˆ‡ã®ä¿®æ­£ãŒã§ãã¾ã›ã‚“
                    </p>
                </div>

                <label class="block text-sm font-medium text-slate-300 mb-3">
                    AIã¨ã®æ ¼é—˜è¨˜éŒ²ï¼ˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå±¥æ­´ï¼‰<span class="text-red-400">*</span>
                </label>
                <textarea id="initialPromptLog" rows="12" placeholder="AIã¨ã®ã‚„ã‚Šå–ã‚Šã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„...

ä¾‹:
User: ã“ã‚“ãªã‚¢ãƒ—ãƒªã‚’ä½œã‚ŠãŸã„ã‚“ã ã‘ã©...
AI: ãã‚Œã¯é¢ç™½ã„ã§ã™ã­ï¼ã“ã†ã„ã†æ©Ÿèƒ½ã¯ã©ã†ã§ã—ã‚‡ã†ï¼Ÿ
User: ã„ã„ã­ï¼ã§ã‚‚ã“ã“ã¯ã‚‚ã£ã¨..."
                    class="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-xl text-slate-300 placeholder-slate-600 focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20 outline-none transition mono text-sm"></textarea>

                <p class="text-xs text-slate-500 mt-2">
                    ğŸ”’ ã“ã®å±¥æ­´ã¯ã€Œè–åŸŸã€ã¨ã—ã¦æ°¸ä¹…ä¿å­˜ã•ã‚Œã¾ã™ã€‚å½“æ™‚ã®ç†±é‡ã‚’ãã®ã¾ã¾æ®‹ã—ã¦ãã ã•ã„ã€‚
                </p>
            </div>

            <!-- STEP 3: ä½œå“è©³ç´° -->
            <div id="step3" class="step border-2 border-slate-700 rounded-2xl p-8 bg-slate-800/50">
                <div class="flex items-center gap-3 mb-6">
                    <div
                        class="w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400 font-semibold border border-blue-500/30">
                        3
                    </div>
                    <h3 class="text-xl font-semibold text-white">ä½œå“è©³ç´°ã¨ã“ã ã‚ã‚Š</h3>
                </div>

                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">
                            ã‚¢ãƒ—ãƒªå<span class="text-red-400">*</span>
                        </label>
                        <input type="text" id="title" placeholder="ä¾‹: èª°å¾—ã‚¿ã‚¤ãƒãƒ¼"
                            class="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-xl text-white placeholder-slate-600 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 outline-none transition">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">
                            URLï¼ˆä»»æ„ï¼‰
                        </label>
                        <input type="url" id="url" placeholder="https://..."
                            class="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-xl text-white placeholder-slate-600 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 outline-none transition">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">
                            ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆï¼ˆå¾Œã§ç·¨é›†å¯èƒ½ï¼‰
                        </label>
                        <textarea id="devObsession" rows="6"
                            placeholder="ã“ã®ã‚¢ãƒ—ãƒªã®ã©ã“ã«ã“ã ã‚ã£ãŸã‹ã€æŠ€è¡“çš„ãªå·¥å¤«ã€ãªãœä½œã£ãŸã®ã‹...ãªã©ã€ã‚ãªãŸã®æƒ³ã„ã‚’èªã£ã¦ãã ã•ã„ã€‚"
                            class="w-full px-4 py-3 bg-slate-900 border border-slate-700 rounded-xl text-slate-300 placeholder-slate-600 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 outline-none transition"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <!-- Submit Button -->
        <div class="mt-10 text-center">
            <button onclick="submitProduct()"
                class="px-10 py-4 bg-purple-500 hover:bg-purple-600 text-white font-semibold rounded-xl transition shadow-lg shadow-purple-500/20">
                åˆæœŸè¡å‹•ã‚’å°å°ã—ã¦æŠ•ç¨¿ã™ã‚‹
            </button>
            <p class="text-xs text-slate-500 mt-4">
                æŠ•ç¨¿å¾Œã€AIã¨ã®å±¥æ­´ã¯ç·¨é›†ã§ããªããªã‚Šã¾ã™
            </p>
        </div>
    </main>

    <script type="module">
        import { checkAuth, apiRequest, validateRequired } from './js/common.js';

        // èªè¨¼ãƒã‚§ãƒƒã‚¯
        const auth = checkAuth(true, 'wakuwaku');
        const currentUserHash = auth.userHash;

        // ãƒ™ãƒ¼ã‚¹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å–å¾—
        async function loadBasePrompt() {
            try {
                const data = await apiRequest('/api/wakuwaku/base-prompt');
                document.getElementById('basePrompt').textContent = data.prompt;
            } catch (err) {
                console.error(err);
                document.getElementById('basePrompt').textContent = 'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ';
            }
        }

        function copyPrompt() {
            const prompt = document.getElementById('basePrompt').textContent;
            navigator.clipboard.writeText(prompt).then(() => {
                alert('ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\nAIã¨ã®å¯¾è©±ã‚’æ¥½ã—ã‚“ã§ãã ã•ã„ã€‚');
            });
        }
        window.copyPrompt = copyPrompt;

        async function submitProduct() {
            const title = document.getElementById('title').value.trim();
            const url = document.getElementById('url').value.trim();
            const initialPromptLog = document.getElementById('initialPromptLog').value.trim();
            const devObsession = document.getElementById('devObsession').value.trim();

            if (!validateRequired(title, 'ã‚¢ãƒ—ãƒªå') || !validateRequired(initialPromptLog, 'AIã¨ã®æ ¼é—˜è¨˜éŒ²')) {
                return;
            }

            if (!confirm('æœ¬å½“ã«æŠ•ç¨¿ã—ã¾ã™ã‹ï¼Ÿ\n\nAIã¨ã®å±¥æ­´ã¯æŠ•ç¨¿å¾Œã«ç·¨é›†ã§ããªããªã‚Šã¾ã™ã€‚')) {
                return;
            }

            try {
                const data = await apiRequest('/api/wakuwaku/post-product', {
                    method: 'POST',
                    body: JSON.stringify({
                        title,
                        url: url || null,
                        initial_prompt_log: initialPromptLog,
                        dev_obsession: devObsession || null,
                        user_hash: currentUserHash
                    })
                });

                if (data.success) {
                    alert('æŠ•ç¨¿å®Œäº†ã—ã¾ã—ãŸï¼\nã‚ãªãŸã®åˆæœŸè¡å‹•ãŒæ°¸ä¹…ä¿å­˜ã•ã‚Œã¾ã—ãŸã€‚');
                    location.href = 'wakuwaku.html';
                } else {
                    alert('ã‚¨ãƒ©ãƒ¼: ' + (data.message || 'ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'));
                }
            } catch (err) {
                console.error('æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:', err);
                alert('æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\n\nè©³ç´°: ' + err.message);
            }
        }
        window.submitProduct = submitProduct;

        // åˆæœŸåŒ–
        loadBasePrompt();
    </script>
</body>

</html>